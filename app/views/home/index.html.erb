<div class="row">
  <div class="col-md-8 offset-2">
    <div class="container">
      <div class="row">

        <% @products.each do |product| %>
          <% if product.total_stock > 0 %>
            
            <div class="col-md-3">
              <div class="card">
                <img class="card-img-top" src="https://dummyimage.com/600x400/c7c7c7/737373&text=image" alt="<%= product.name %>"/>

                <div class="card-block">
                  <h5 class="card-title"><%= product.name %></h5>

                  <div class="card-text">
                    <div class="badge badge-primary"><%= product.category.name %></div>
                    <div>$<%= product.price %></div>
                    <ul>
                      <% product.variations.each do |variation| %>
                        <% variation.properties.each do |property| %>
                          <% if property.stock > 0 %>
                            <li><%= property.full_name %></li>
                          <% end %>
                        <% end %>
                      <% end %>
                    </ul>
                  </div>

                  <div class="row float-right">
                    <div class="col-md-12">

                      <%= form_for :cart, url: cart_path, method: :put do |f| %>
                        <%= f.collection_select :product_id, product.all_variation, :id, :full_name, { include_blank: true }  %>
                        <%# <%= f.hidden_field :product_id, value: product.id %>
                        <%= f.hidden_field :quantity, value: 1 %>
                        <%= f.submit "Add to cart" %>
                      <% end %>
                      
                    </div>
                  </div>

                </div>
              </div>
            </div>
          <% end %>
        <% end %>
        
      </div>
    </div>
  </div>
</div>
